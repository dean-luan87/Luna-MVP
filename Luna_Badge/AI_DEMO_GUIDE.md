# Luna Badge AI感知演示指南

## 🎯 功能概述

Luna Badge现在具备了完整的AI感知与语音输出能力，实现了"看→听→说"的推理链路：

- **YOLOv11n环境识别**: 实时检测行人、车辆、道路、障碍物
- **Whisper语音识别**: 识别中文语音并转换为文本
- **Edge-TTS语音播报**: 使用中文女声进行语音输出

## 📦 依赖安装

首先安装所需的依赖包：

```bash
pip install ultralytics openai-whisper edge-tts opencv-python numpy
```

## 🚀 使用方法

### 1. 生成测试音频文件

```bash
python create_test_audio.py
```

这将生成一个包含中文测试语音的`test_audio.wav`文件。

### 2. 运行AI感知演示

```bash
python main_mac.py --ai-demo
```

这将启动AI感知演示模式，包含：

1. **YOLO实时识别** (10秒)
   - 启动摄像头
   - 实时检测环境中的物体
   - 检测到行人、车辆等时播报安全提示

2. **Whisper语音识别**
   - 识别测试音频文件中的中文语音
   - 输出识别结果

3. **Edge-TTS语音播报**
   - 播报系统状态信息
   - 使用中文女声进行语音输出

### 3. 正常运行模式

```bash
python main_mac.py
```

这将启动正常的系统循环模式。

## 📋 预期输出

运行AI演示模式后，终端应显示：

```
🌟 Luna Badge - Mac版本
==================================================
🚀 启动AI感知演示模式
🌟 启动Luna AI感知演示
==================================================

📹 启动YOLO环境识别...
🚀 正在加载YOLOv11n模型...
✅ YOLOv11n模型加载成功
🚀 YOLO 推理启动
🔍 检测到: person (置信度: 0.85)
⚠️ 安全提示: 检测到行人，请注意避让
🗣️ 正在播报: 检测到行人，请注意避让
🗣️ 播报完成
✅ YOLO检测完成

🎧 启动Whisper语音识别...
🎧 正在加载Whisper模型...
✅ Whisper模型加载成功
🎧 Whisper 听取中
用户说：你好，我是Luna AI助手，正在测试语音识别功能。
✅ Whisper识别完成

🗣️ 测试语音播报...
🗣️ 正在播报: Luna AI感知系统启动完成
🗣️ 播报完成
🗣️ 正在播报: 环境识别功能正常
🗣️ 播报完成
🗣️ 正在播报: 语音识别功能正常
🗣️ 播报完成
🗣️ 正在播报: 语音播报功能正常
🗣️ 播报完成

🎉 Luna AI感知演示完成！
```

## 🔧 功能特性

### YOLO环境识别
- **实时检测**: 每5帧进行一次检测，降低计算负载
- **安全提示**: 检测到行人、车辆等时自动播报安全提示
- **可视化**: 显示检测窗口，实时查看检测结果
- **置信度**: 显示检测对象的置信度分数

### Whisper语音识别
- **中文支持**: 专门针对中文语音进行优化
- **文件输入**: 支持从音频文件进行识别
- **高精度**: 使用Whisper base模型确保识别准确性

### Edge-TTS语音播报
- **中文女声**: 使用"zh-CN-XiaoxiaoNeural"语音
- **异步播报**: 支持异步语音播报，不阻塞主程序
- **临时文件**: 自动管理临时音频文件

## ⚠️ 注意事项

1. **摄像头权限**: 确保应用有摄像头访问权限
2. **网络连接**: Edge-TTS需要网络连接生成音频
3. **模型下载**: 首次运行时YOLO和Whisper模型会自动下载
4. **音频文件**: 测试音频文件需要先运行`create_test_audio.py`生成

## 🐛 故障排除

### 常见问题

1. **摄像头初始化失败**
   - 检查摄像头是否被其他程序占用
   - 确认摄像头权限设置

2. **模型加载失败**
   - 检查网络连接
   - 确认依赖包安装正确

3. **语音播报失败**
   - 检查网络连接
   - 确认Edge-TTS安装正确

4. **音频文件不存在**
   - 先运行`python create_test_audio.py`生成测试音频

### 调试模式

如果遇到问题，可以查看详细的错误信息：

```bash
python main_mac.py --ai-demo 2>&1 | tee debug.log
```

## 🎉 总结

Luna Badge现在具备了完整的AI感知能力：

- ✅ **视觉感知**: YOLO实时环境识别
- ✅ **听觉感知**: Whisper语音识别
- ✅ **语音输出**: Edge-TTS中文语音播报
- ✅ **安全提示**: 自动检测并播报安全信息
- ✅ **完整链路**: "看→听→说"推理链路完整实现

系统已准备好进行实际的AI感知应用！🚀
