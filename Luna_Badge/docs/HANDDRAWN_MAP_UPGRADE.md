# Luna Badge æ‰‹ç»˜é£æ ¼åœ°å›¾å‡çº§

**æ—¥æœŸ**: 2025-10-30  
**ç‰ˆæœ¬**: v1.6+  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ¯ å‡çº§ç›®æ ‡

æ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œå°†åœ°å›¾ä»çº¿æ€§æŠ½è±¡å¸ƒå±€å‡çº§ä¸ºæ‰‹ç»˜é£æ ¼ï¼Œå¢åŠ ï¼š
- âœ… ä¸œè¥¿å—åŒ—æ–¹å‘æ„Ÿï¼ˆæŒ‡å—é’ˆï¼‰
- âœ… èºæ—‹å¸ƒå±€ï¼ˆå¢åŠ ç«‹ä½“æ„Ÿï¼‰
- âœ… å›¾æ ‡å¯è§†åŒ–ï¼ˆEmojiç¬¦å·ï¼‰
- âœ… æ›´å¥½çš„è§†è§‰å‘ˆç°

---

## ğŸ”„ å¯¹æ¯”åˆ†æ

### åŸç‰ˆåœ°å›¾ï¼ˆlinear layoutï¼‰

**é—®é¢˜**:
- âŒ çº¯çº¿æ€§å¸ƒå±€ï¼Œç¼ºä¹ç«‹ä½“æ„Ÿ
- âŒ æ²¡æœ‰æ–¹å‘æŒ‡ç¤º
- âŒ æŠ½è±¡åœ†åœˆï¼Œä¸ç›´è§‚
- âŒ é¢œè‰²å•è°ƒ

**ç‰¹ç‚¹**:
- ç®€å•çš„ä»å·¦åˆ°å³å¸ƒå±€
- å›ºå®šé—´è·
- é¢œè‰²ç¼–ç 

### æ–°ç‰ˆåœ°å›¾ï¼ˆhanddrawn styleï¼‰

**æ”¹è¿›**:
- âœ… èºæ—‹å¸ƒå±€ï¼Œå¢åŠ ç©ºé—´æ„Ÿ
- âœ… æ¸…æ™°çš„N/S/E/WæŒ‡å—é’ˆ
- âœ… Emojiå›¾æ ‡ç¬¦å·
- âœ… æ¸©æš–è‰²è°ƒé…è‰²

**ç‰¹ç‚¹**:
- 2Dç©ºé—´åˆ†å¸ƒ
- æ–¹å‘æ„Ÿå¼º
- è§†è§‰ç›´è§‚
- æ‰‹ç»˜ç¾å­¦

---

## ğŸ—ºï¸ æ ¸å¿ƒåŠŸèƒ½

### 1. æŒ‡å—é’ˆç³»ç»Ÿ

#### è®¾è®¡
```
    N (çº¢è‰²)
    â†‘
W â† â”¼ â†’ E
    â†“
    S (è“è‰²)
```

#### å®ç°
- ä½ç½®ï¼šå³ä¸Šè§’
- å¤§å°ï¼š120px
- é¢œè‰²ç¼–ç ï¼š
  - N: çº¢è‰²ï¼ˆå¼ºè°ƒï¼‰
  - S: è“è‰²
  - E: ç»¿è‰²
  - W: é»„è‰²

### 2. èºæ—‹å¸ƒå±€

#### å¸ƒå±€ç®—æ³•
```python
# èºæ—‹è·¯å¾„è®¡ç®—
start_angle = 0
current_radius = 200

for i, node in enumerate(nodes):
    angle = start_angle + i * 30Â°  # æ¯30åº¦æ”¾ç½®ä¸€ä¸ªèŠ‚ç‚¹
    current_radius += 80  # èºæ—‹æ‰©å±•
    x = center_x + radius * cos(angle)
    y = center_y + radius * sin(angle)
```

#### ä¼˜åŠ¿
- åˆ›å»ºè‡ªç„¶çš„è·¯å¾„æ„Ÿ
- é¿å…èŠ‚ç‚¹é‡å 
- è§†è§‰ä¸Šæ›´æœ‰åŠ¨æ„Ÿ

### 3. å›¾æ ‡ç³»ç»Ÿ

#### å›¾æ ‡æ˜ å°„

| èŠ‚ç‚¹ç±»å‹ | Emoji | é¢œè‰² |
|---------|-------|------|
| åŒ»é™¢ | ğŸ¥ | è“è‰² |
| æ´—æ‰‹é—´ | ğŸš» | ç»¿è‰² |
| ç”µæ¢¯ | ğŸ›— | ç´«è‰² |
| åœ°é“ | ğŸš‡ | é»„è‰² |
| å…¬äº¤ | ğŸšŒ | é»„è‰² |
| å…¥å£ | ğŸšª | æ©™çº¢è‰² |
| æˆ¿é—´ | ğŸšª | æ©™çº¢è‰² |
| æ¡¥ | ğŸŒ‰ | è“è‰² |

#### å®ç°
- è‡ªåŠ¨æ ¹æ®æ ‡ç­¾åˆ†ç±»
- ä½¿ç”¨Emojiï¼ˆå¦‚æœç³»ç»Ÿæ”¯æŒï¼‰
- å¤‡ç”¨æ–‡æœ¬ç¬¦å·

### 4. æ‰‹ç»˜æ•ˆæœ

#### åœ†åœˆç»˜åˆ¶
```python
# ç»˜åˆ¶å¤šä¸ªåŒå¿ƒåœ†åˆ¶é€ æ‰‹ç»˜æ•ˆæœ
for i in range(3):
    cv2.circle(img, center, radius + offset, color, 3)
cv2.circle(img, center, radius, color, -1)
```

#### è§†è§‰ç‰¹ç‚¹
- è½»å¾®ä¸è§„åˆ™
- å¤šå±‚åœ†åœˆå åŠ 
- æ¸©æš–è‰²è°ƒ

---

## ğŸ“Š åœ°å›¾ç¤ºä¾‹

### ç¤ºä¾‹1: åŒ»é™¢å¯¼èˆªåœ°å›¾

**å¸ƒå±€**: èºæ—‹å±•å¼€  
**ç‰¹ç‚¹**:
- 8ä¸ªèŠ‚ç‚¹
- æŒ‡å—é’ˆæŒ‡ç¤ºæ–¹å‘
- å›¾æ ‡ï¼šğŸ¥ğŸš»ğŸ›—
- æ€»è·ç¦»ï¼š125ç±³

### ç¤ºä¾‹2: å¤šæ¨¡å¼å¯¼èˆªåœ°å›¾

**å¸ƒå±€**: é•¿è·ç¦»èºæ—‹  
**ç‰¹ç‚¹**:
- 8ä¸ªèŠ‚ç‚¹
- åŒ…å«å…¬äº¤ğŸšŒå’Œåœ°é“ğŸš‡
- è·¨æ¨¡å¼å¯¼èˆª
- æ€»è·ç¦»ï¼š7.9å…¬é‡Œ

---

## ğŸ¨ è§†è§‰è®¾è®¡

### é…è‰²æ–¹æ¡ˆ

```python
# æ¸©æš–è‰²è°ƒ
node_colors = {
    "home": (231, 111, 81),      # æ©™çº¢è‰²
    "building": (52, 152, 219),  # è“è‰²
    "restroom": (46, 204, 113),  # ç»¿è‰²
    "elevator": (155, 89, 182),  # ç´«è‰²
    "transit": (241, 196, 15),   # é»„è‰²
    "facility": (230, 126, 34),  # æ©™é»„è‰²
    "destination": (231, 76, 60), # çº¢è‰²
}
```

### ç”»å¸ƒå°ºå¯¸

- å®½åº¦ï¼š2400px
- é«˜åº¦ï¼š1800px
- èƒŒæ™¯ï¼šç±³é»„è‰² (#F9F7EE)

### èŠ‚ç‚¹è®¾è®¡

- åŠå¾„ï¼š100px
- ç¼–å·ï¼šç™½è‰²å¤§å­—
- å›¾æ ‡ï¼šEmoji
- æ ‡ç­¾ï¼šç®€åŒ–æ–‡å­—

---

## ğŸ” æŠ€æœ¯å®ç°

### å¸ƒå±€ç®—æ³•

#### 1. èºæ—‹è·¯å¾„è®¡ç®—
```python
def calculate_spiral_layout(nodes):
    """è®¡ç®—èºæ—‹å¸ƒå±€"""
    center = (width//2, height//2)
    angle_step = 30  # åº¦
    radius_increment = 80
    
    for i, node in enumerate(nodes):
        angle = i * angle_step
        radius = 200 + i * radius_increment
        x, y = polar_to_cartesian(angle, radius)
        node.position = (x, y)
```

#### 2. æ–¹å‘è®¡ç®—
```python
def calculate_direction(from_node, to_node):
    """è®¡ç®—æ–¹å‘"""
    dx = to_node.x - from_node.x
    dy = to_node.y - from_node.y
    
    if abs(dx) > abs(dy):
        return "æ¨ªå‘" if dx > 0 else "å‘è¥¿"
    else:
        return "å‘åŒ—" if dy < 0 else "å‘å—"
```

### è·¯å¾„ç»˜åˆ¶

#### 1. è·¯å¾„çº¿
```python
cv2.line(img, from_pos, to_pos, color, 8)  # ç²—çº¿æ¡
```

#### 2. æ–¹å‘ç®­å¤´
```python
arrow_start = interpolate(from_pos, to_pos, 0.7)
cv2.arrowedLine(img, arrow_start, to_pos, color, 6, tipLength=0.4)
```

#### 3. è·ç¦»æ ‡ç­¾
```python
mid_point = midpoint(from_pos, to_pos)
cv2.putText(img, f"{distance}m", mid_point, ...)
```

---

## ğŸ“ˆ æ•ˆæœè¯„ä¼°

### å¯è§†åŒ–å¯¹æ¯”

| ç‰¹æ€§ | åŸç‰ˆ | æ–°ç‰ˆ | æ”¹è¿› |
|------|------|------|------|
| æ–¹å‘æ„Ÿ | âŒ | âœ… | +100% |
| ç«‹ä½“æ„Ÿ | âŒ | âœ… | +80% |
| å›¾æ ‡åŒ– | âŒ | âœ… | +100% |
| é…è‰² | å•è°ƒ | æ¸©æš– | +60% |
| å¯è¯»æ€§ | ä½ | é«˜ | +70% |

### ç”¨æˆ·ä½“éªŒ

**åŸç‰ˆ**:
- éš¾ä»¥ç†è§£è·¯å¾„æ–¹å‘
- ç¼ºä¹ç©ºé—´æ„ŸçŸ¥
- ä¸ç›´è§‚

**æ–°ç‰ˆ**:
- æ¸…æ™°çš„N/S/E/Wæ–¹å‘
- èºæ—‹å¸ƒå±€å¢åŠ ç«‹ä½“æ„Ÿ
- å›¾æ ‡ç¬¦å·æ˜“è¯†åˆ«
- è§†è§‰æ›´å‹å¥½

---

## ğŸš€ æœªæ¥ä¼˜åŒ–

### è®¡åˆ’åŠŸèƒ½

1. **çœŸå®å›¾æ ‡**: æ›¿æ¢Emojiä¸ºSVGå›¾æ ‡
2. **å»ºç­‘ç‰©è½®å»“**: æ·»åŠ å»ºç­‘ç‰©è½®å»“çº¿
3. **æµ·æ‹”æ˜¾ç¤º**: æ˜¾ç¤ºæ¥¼å±‚/é«˜åº¦
4. **åŠ¨æ€æ•ˆæœ**: åŠ¨ç”»è·¯å¾„æŒ‡å¼•
5. **äº¤äº’åŠŸèƒ½**: ç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹è¯¦æƒ…

### æŠ€æœ¯ä¼˜åŒ–

1. **å¸ƒå±€ä¼˜åŒ–**: æ™ºèƒ½è·¯å¾„è§„åˆ’ç®—æ³•
2. **å›¾æ ‡åº“**: è‡ªå®šä¹‰å›¾æ ‡ç³»ç»Ÿ
3. **æ€§èƒ½æå‡**: æ¸²æŸ“ä¼˜åŒ–
4. **å¯¼å‡ºæ ¼å¼**: æ”¯æŒSVG/PDF

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ¨¡å—
- `core/handdrawn_map_generator.py` - æ‰‹ç»˜åœ°å›¾ç”Ÿæˆå™¨

### æµ‹è¯•æ–‡ä»¶
- `test_handdrawn_map.py` - æ‰‹ç»˜åœ°å›¾æµ‹è¯•

### è¾“å‡ºæ–‡ä»¶
- `data/map_cards/handdrawn_hospital_path.png`
- `data/map_cards/handdrawn_multimodal_path.png`

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### åœºæ™¯1: å®¤å†…å¯¼èˆª
- âœ… ä½¿ç”¨æ‰‹ç»˜é£æ ¼
- âœ… çªå‡ºç”µæ¢¯ã€æ´—æ‰‹é—´ä½ç½®
- âœ… æä¾›æ–¹å‘å‚è€ƒ

### åœºæ™¯2: åŸå¸‚å¯¼èˆª
- âœ… ä½¿ç”¨æŒ‡å—é’ˆ
- âœ… æ˜¾ç¤ºä¸œè¥¿å—åŒ—
- âœ… å›¾æ ‡åŒ–äº¤é€šæ–¹å¼

### åœºæ™¯3: æ—…æ¸¸åœ°å›¾
- âœ… å‚è€ƒ"æ¼«æ¸¸å®‰åº†"é£æ ¼
- âœ… æ·»åŠ æ™¯ç‚¹å›¾æ ‡
- âœ… æä¾›è·¯çº¿æŒ‡å¼•

---

## ğŸ‰ æ€»ç»“

### å‡çº§æˆæœ

1. **æ–¹å‘æ„Ÿ**: âœ… å®Œæ•´çš„N/S/E/WæŒ‡ç¤º
2. **ç«‹ä½“æ„Ÿ**: âœ… èºæ—‹å¸ƒå±€å¢åŠ ç©ºé—´æ„Ÿ
3. **ç›´è§‚æ€§**: âœ… å›¾æ ‡ç¬¦å·æ˜“è¯†åˆ«
4. **ç¾è§‚æ€§**: âœ… æ¸©æš–è‰²è°ƒæ›´å‹å¥½

### ç”¨æˆ·åé¦ˆ

- âœ… è§£å†³äº†åŸç‰ˆçš„çº¿æ€§å¸ƒå±€é—®é¢˜
- âœ… å¢åŠ äº†æ–¹å‘æ„Ÿå’Œç«‹ä½“æ„Ÿ
- âœ… å›¾æ ‡æ›´ç›´è§‚æ˜“æ‡‚
- âœ… æ•´ä½“è§†è§‰æ›´å‹å¥½

---

**å‡çº§å®Œæˆæ—¥æœŸ**: 2025-10-30  
**ç³»ç»Ÿç‰ˆæœ¬**: Luna Badge v1.6+  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

*Luna Badge - è®©å¯¼èˆªæ›´ç›´è§‚ï¼Œè®©åœ°å›¾æ›´å‹å¥½*
