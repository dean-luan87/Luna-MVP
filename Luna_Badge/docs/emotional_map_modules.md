# Luna Badge æƒ…ç»ªåœ°å›¾æ¨¡å—ç³»ç»Ÿ

**æ—¥æœŸ**: 2025-10-30  
**ç‰ˆæœ¬**: v1.6+  
**çŠ¶æ€**: âœ… å®Œæˆ

---

## ğŸ“‹ æ¦‚è¿°

Luna Badge æƒ…ç»ªåœ°å›¾æ¨¡å—ç³»ç»Ÿæ˜¯ä¸€ç»„ç”¨äºç”Ÿæˆæ‰‹ç»˜é£æ ¼ã€å¸¦æƒ…ç»ªæ ‡æ³¨çš„å¯¼èˆªåœ°å›¾çš„å·¥å…·ã€‚ç³»ç»ŸåŒ…å«å››ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæ”¯æŒä»è®°å¿†å­˜å‚¨ä¸­æå–è·¯å¾„æ•°æ®ï¼Œä¸ºèŠ‚ç‚¹åˆ†é…å±‚çº§ã€æ ‡æ³¨æƒ…ç»ªã€æ„å»ºé‚»æ¥å›¾ï¼Œå¹¶æœ€ç»ˆç”Ÿæˆå¯è§†åŒ–çš„æƒ…ç»ªåœ°å›¾ã€‚

---

## ğŸ—ºï¸ æ¨¡å—æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æƒ…ç»ªåœ°å›¾æ¨¡å—ç³»ç»Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Module 1: Emotional Map Card Generator  â”‚  â”‚
â”‚  â”‚  emotional_map_card_generator.py         â”‚  â”‚
â”‚  â”‚  - ç”ŸæˆPNG/PDFæ‰‹ç»˜é£æ ¼åœ°å›¾                 â”‚  â”‚
â”‚  â”‚  - åº”ç”¨çº¸å¼ çº¹ç†å’Œæ‰‹ç»˜æ•ˆæœ                  â”‚  â”‚
â”‚  â”‚  - æ¸²æŸ“æƒ…ç»ªæ ‡ç­¾ã€å›¾æ ‡ã€æ–¹å‘çº¿              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Module 2: Node Layer Manager            â”‚  â”‚
â”‚  â”‚  node_layer_manager.py                   â”‚  â”‚
â”‚  â”‚  - è‡ªåŠ¨åˆ†é…èŠ‚ç‚¹å±‚çº§                       â”‚  â”‚
â”‚  â”‚  - åˆ†ç±»å®¤å¤–/æ¥¼å†…/ç”µæ¢¯é—´ç­‰                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Module 3: Adjacency Graph Builder       â”‚  â”‚
â”‚  â”‚  adjacency_graph_builder.py              â”‚  â”‚
â”‚  â”‚  - æ„å»ºèŠ‚ç‚¹é‚»æ¥å…³ç³»                       â”‚  â”‚
â”‚  â”‚  - æ”¯æŒè·¯å¾„æŸ¥æ‰¾                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Module 4: Emotional Tagger              â”‚  â”‚
â”‚  â”‚  emotional_tagger.py                     â”‚  â”‚
â”‚  â”‚  - æå–æƒ…ç»ªæ ‡ç­¾                           â”‚  â”‚
â”‚  â”‚  - å…³é”®è¯æ˜ å°„åˆ°emoji                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æ¨¡å—è¯¦ç»†è¯´æ˜

### Module 1: Emotional Map Card Generator

**æ–‡ä»¶**: `core/emotional_map_card_generator.py`

**åŠŸèƒ½**:
- ç”Ÿæˆæ‰‹ç»˜é£æ ¼çš„æƒ…ç»ªåœ°å›¾å›¾å¡
- ä½¿ç”¨PILå’Œmatplotlibè¿›è¡Œç»˜åˆ¶
- æ”¯æŒçº¸å¼ çº¹ç†å’Œæ‰‹ç»˜æŠ–åŠ¨æ•ˆæœ

**ä¸»è¦æ–¹æ³•**:
- `generate_emotional_map(path_id, path_name, nodes)` - ç”Ÿæˆæƒ…ç»ªåœ°å›¾
- `_apply_paper_texture(img)` - åº”ç”¨çº¸å¼ çº¹ç†
- `_draw_shaky_line(draw, coords, color)` - ç»˜åˆ¶æŠ–åŠ¨çº¿æ¡
- `_render_node_icon(node_type, size)` - æ¸²æŸ“èŠ‚ç‚¹å›¾æ ‡
- `_render_emotion_tag(emotion, position, img)` - æ¸²æŸ“æƒ…ç»ªæ ‡ç­¾

**è¾“å…¥**:
- `path_id`: è·¯å¾„ID
- `path_name`: è·¯å¾„åç§°ï¼ˆå¯é€‰ï¼‰
- `nodes`: èŠ‚ç‚¹åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰

**è¾“å‡º**:
- PNGæ ¼å¼çš„æƒ…ç»ªåœ°å›¾æ–‡ä»¶
- ä¿å­˜åœ¨ `data/map_cards/<path_id>_emotional.png`

**é…ç½®**:
```python
emotion_map = {
    "çƒ­é—¹": {"emoji": "ğŸ‰", "color": (255, 100, 100)},
    "å®‰é™": {"emoji": "ğŸ¤«", "color": (100, 150, 255)},
    "æ¨è": {"emoji": "â­", "color": (255, 200, 100)},
    ...
}

hand_drawn_style = {
    "paper_color": (249, 247, 238),  # ç±³é»„è‰²çº¸å¼ 
    "line_color": (50, 50, 50),      # é»‘è‰²çº¿æ¡
    "shadow_color": (200, 200, 200), # ç°è‰²é˜´å½±
    "texture_alpha": 30,              # çº¹ç†é€æ˜åº¦
}
```

---

### Module 2: Node Layer Manager

**æ–‡ä»¶**: `core/node_layer_manager.py`

**åŠŸèƒ½**:
- è‡ªåŠ¨ä¸ºèŠ‚ç‚¹åˆ†é…å±‚çº§æ ‡ç­¾
- æ”¯æŒå®¤å†…/å®¤å¤–ã€æ¥¼å±‚ã€åŠŸèƒ½åŒºåŸŸåˆ†ç±»
- æ”¯æŒä»è·¯å¾„åç§°æ¨æ–­å±‚çº§

**ä¸»è¦æ–¹æ³•**:
- `assign_level(node)` - ä¸ºå•ä¸ªèŠ‚ç‚¹åˆ†é…å±‚çº§
- `update_all_levels(memory_store_path, output_path)` - æ‰¹é‡æ›´æ–°æ‰€æœ‰èŠ‚ç‚¹å±‚çº§
- `get_level_hierarchy(memory_store_path)` - è·å–å±‚çº§ç»“æ„æ ‘

**å±‚çº§åˆ†ç±»**:
```
å®¤å¤– â†’ å®¤å¤–ä¸»è·¯/äººè¡Œé“/å¹¿åœº
å…¥å£åŒº â†’ å¤§é—¨/é—¨å…/å‰å°/æ¥å¾…
æ¥¼å±‚ â†’ ä¸€æ¥¼/äºŒæ¥¼/ä¸‰æ¥¼... + åŒºåŸŸ(ä¸œ/è¥¿/ä¸­)
ç”µæ¢¯é—´ â†’ ç”µæ¢¯/å‡é™æ¢¯/ç›´æ¢¯
æ¥¼æ¢¯é—´ â†’ æ¥¼æ¢¯/å°é˜¶/æ­¥æ¢¯
èµ°å»Š â†’ èµ°å»Š/é€šé“/è¿‡é“
å€™è¯ŠåŒº â†’ å€™è¯Š/ç­‰å¾…åŒº
ç§‘å®¤ â†’ ç§‘å®¤/è¯Šå®¤/ç—…æˆ¿
å«ç”Ÿé—´ â†’ å•æ‰€/æ´—æ‰‹é—´
ç»ˆç«¯èŠ‚ç‚¹ â†’ ç»ˆç‚¹/ç›®çš„åœ°
åŠŸèƒ½é”šç‚¹ â†’ é”šç‚¹/å…³é”®ç‚¹/è½¬ä¹˜
```

**ç¤ºä¾‹**:
```python
node = {"label": "åŒ»é™¢ä¸‰æ¥¼ä¸œä¾§å«ç”Ÿé—´"}
level = manager.assign_level(node)
# è¿”å›: "ä¸‰æ¥¼ ä¸œåŒº"
```

---

### Module 3: Adjacency Graph Builder

**æ–‡ä»¶**: `core/adjacency_graph_builder.py`

**åŠŸèƒ½**:
- ä¸ºè·¯å¾„ä¸­çš„èŠ‚ç‚¹æ„å»ºé‚»æ¥å…³ç³»å›¾
- æ·»åŠ `adjacent`å­—æ®µå­˜å‚¨ç›¸é‚»èŠ‚ç‚¹ID
- æ”¯æŒBFSè·¯å¾„æœç´¢
- æ£€æµ‹è·¨è·¯å¾„è¿æ¥ç‚¹

**ä¸»è¦æ–¹æ³•**:
- `build_adjacency_graph(memory_store_path, output_path)` - æ„å»ºé‚»æ¥å›¾
- `get_adjacent_nodes(memory_store_path, path_id, node_id)` - è·å–ç›¸é‚»èŠ‚ç‚¹
- `find_shortest_path(memory_store_path, start_node_id, end_node_id)` - æŸ¥æ‰¾æœ€çŸ­è·¯å¾„
- `get_graph_statistics(memory_store_path)` - è·å–å›¾ç»Ÿè®¡ä¿¡æ¯

**æ•°æ®ç»“æ„**:
```json
{
  "node_id": "path1_node_2",
  "adjacent": ["path1_node_1", "path1_node_3"]
}
```

**ç»Ÿè®¡ä¿¡æ¯**:
```python
{
  "total_nodes": 50,
  "total_edges": 98,
  "isolated_nodes": 2,
  "max_degree": 4,
  "cross_path_connections": 5
}
```

---

### Module 4: Emotional Tagger

**æ–‡ä»¶**: `core/emotional_tagger.py`

**åŠŸèƒ½**:
- ä»ç”¨æˆ·æ–‡æœ¬ä¸­æå–æƒ…ç»ªæ ‡ç­¾
- å…³é”®è¯æ˜ å°„åˆ°emoji
- æ‰¹é‡æ ‡æ³¨èŠ‚ç‚¹æƒ…ç»ª
- æ”¯æŒè‡ªå®šä¹‰æƒ…ç»ªè§„åˆ™

**ä¸»è¦æ–¹æ³•**:
- `extract_emotion_tags(note)` - æå–æƒ…ç»ªæ ‡ç­¾
- `tag_nodes_with_emotion(memory_store_path, output_path)` - æ‰¹é‡æ ‡æ³¨
- `get_emotion_emoji(emotion_tag)` - è·å–emoji
- `add_custom_emotion(tag, keywords, emoji)` - æ·»åŠ è‡ªå®šä¹‰æƒ…ç»ª

**æƒ…ç»ªæ˜ å°„è¡¨**:

| æƒ…ç»ªæ ‡ç­¾ | å…³é”®è¯ | Emoji |
|---------|--------|-------|
| çƒ­é—¹ | çƒ­é—¹,æ´»è·ƒ,ç¹å,ç†™æ”˜ | ğŸ‰ |
| æ¨è | æ¨è,å¥½è¯„,å¾ˆèµ,ä¸é”™ | â­ |
| æ¸©é¦¨ | æ¸©é¦¨,æ¸©æš–,èˆ’é€‚ | ğŸ’ |
| å®‰é™ | å®‰é™,æ¸…é™,å®é™ | ğŸ¤« |
| å®½æ• | å®½æ•,å¼€é˜”,ç©ºæ—· | ğŸ›ï¸ |
| å˜ˆæ‚ | å˜ˆæ‚,åµé—¹,å–§é—¹ | ğŸ”Š |
| æ‹¥æŒ¤ | æ‹¥æŒ¤,æŒ¤,å¯† | ğŸ‘¥ |
| çƒ¦èº | çƒ¦èº,çƒ¦,ç„¦è™‘ | ğŸ˜¤ |
| ç­‰å¾… | ç­‰å¾…,æ’é˜Ÿ,ä¹…ç­‰ | â³ |
| æ— éšœç¢ | æ— éšœç¢,æ®‹éšœ,è½®æ¤… | â™¿ |

**ç‰¹æ®Šè§„åˆ™**:
- ç­‰å¾…æ—¶é—´æ£€æµ‹: "ç­‰äº†30åˆ†é’Ÿ" â†’ æ·»åŠ "ç­‰å¾…"æ ‡ç­¾
- äººæ•°åˆ¤æ–­: "äººå¾ˆå¤š" â†’ æ·»åŠ "æ‹¥æŒ¤"æ ‡ç­¾
- äº®åº¦åˆ¤æ–­: "äº®å ‚" â†’ æ·»åŠ "æ˜äº®"æ ‡ç­¾
- æ¸…æ´åº¦åˆ¤æ–­: "å¾ˆå¹²å‡€" â†’ æ·»åŠ "æ•´æ´"æ ‡ç­¾

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
Luna_Badge/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ emotional_map_card_generator.py    # Module 1
â”‚   â”œâ”€â”€ node_layer_manager.py              # Module 2
â”‚   â”œâ”€â”€ adjacency_graph_builder.py         # Module 3
â”‚   â””â”€â”€ emotional_tagger.py                # Module 4
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ memory_store.json                  # è®°å¿†å­˜å‚¨ï¼ˆè¾“å…¥ï¼‰
â”‚   â””â”€â”€ map_cards/                         # åœ°å›¾è¾“å‡ºç›®å½•
â”‚       â”œâ”€â”€ test_emotional_path_emotional.png
â”‚       â””â”€â”€ ...
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ icons/                             # å›¾æ ‡èµ„æº
â””â”€â”€ docs/
    â””â”€â”€ emotional_map_modules.md           # æœ¬æ–‡æ¡£
```

---

## ğŸš€ ä½¿ç”¨æµç¨‹

### æ­¥éª¤1: å‡†å¤‡æ•°æ®

ç¡®ä¿ `data/memory_store.json` åŒ…å«è·¯å¾„æ•°æ®:

```json
{
  "paths": [
    {
      "path_id": "hospital_main_path",
      "path_name": "åŒ»é™¢ä¸»è·¯å¾„",
      "nodes": [
        {"node_id": "node1", "label": "åŒ»é™¢å…¥å£", "type": "entrance"},
        {"node_id": "node2", "label": "ä¸€æ¥¼å¤§å…", "type": "building"},
        {"node_id": "node3", "label": "ä¸‰æ¥¼ç”µæ¢¯é—´", "type": "elevator"},
        {"node_id": "node4", "label": "æ€¥è¯Šç§‘", "type": "destination"}
      ]
    }
  ]
}
```

### æ­¥éª¤2: åˆ†é…å±‚çº§

```python
from core.node_layer_manager import NodeLayerManager

manager = NodeLayerManager()
stats = manager.update_all_levels("data/memory_store.json")
```

### æ­¥éª¤3: æ„å»ºé‚»æ¥å›¾

```python
from core.adjacency_graph_builder import AdjacencyGraphBuilder

builder = AdjacencyGraphBuilder()
stats = builder.build_adjacency_graph("data/memory_store.json")
```

### æ­¥éª¤4: æ ‡æ³¨æƒ…ç»ª

```python
from core.emotional_tagger import EmotionalTagger

tagger = EmotionalTagger()
stats = tagger.tag_nodes_with_emotion("data/memory_store.json")
```

### æ­¥éª¤5: ç”Ÿæˆæƒ…ç»ªåœ°å›¾

```python
from core.emotional_map_card_generator import EmotionalMapCardGenerator

generator = EmotionalMapCardGenerator()
result = generator.generate_emotional_map("hospital_main_path")
```

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•1: å•ä¸ªèŠ‚ç‚¹å±‚çº§åˆ†é…

```python
manager = NodeLayerManager()
test_nodes = [
    {"label": "åŒ»é™¢å…¥å£å¤§é—¨", "type": "entrance"},
    {"label": "ä¸€æ¥¼å¤§å…", "type": "building"},
    {"label": "ä¸‰æ¥¼ç”µæ¢¯é—´", "type": "elevator"},
    {"label": "äºŒæ¥¼ä¸œä¾§å«ç”Ÿé—´", "type": "toilet"},
    {"label": "å®¤å¤–é©¬è·¯", "type": "waypoint"},
]

for node in test_nodes:
    level = manager.assign_level(node)
    print(f"{node['label']:20s} -> {level}")
```

**è¾“å‡º**:
```
åŒ»é™¢å…¥å£å¤§é—¨            -> å…¥å£åŒº
ä¸€æ¥¼å¤§å…                -> ä¸€æ¥¼
ä¸‰æ¥¼ç”µæ¢¯é—´              -> ç”µæ¢¯é—´
äºŒæ¥¼ä¸œä¾§å«ç”Ÿé—´          -> äºŒæ¥¼ ä¸œåŒº
å®¤å¤–é©¬è·¯                -> å®¤å¤–
```

### æµ‹è¯•2: æƒ…ç»ªæ ‡ç­¾æå–

```python
tagger = EmotionalTagger()
test_notes = [
    "è¿™ä¸ªåŒ»é™¢äººå¾ˆå¤šï¼Œç¯å¢ƒå¾ˆå˜ˆæ‚",
    "å«ç”Ÿé—´å¾ˆå¹²å‡€ï¼Œæ¨èä½¿ç”¨",
    "ç­‰å€™å¤§å…å®½æ•æ˜äº®ï¼Œå¾ˆæ¸©é¦¨",
]

for note in test_notes:
    tags = tagger.extract_emotion_tags(note)
    emojis = [tagger.get_emotion_emoji(tag) for tag in tags]
    print(f"æ–‡æœ¬: {note}")
    print(f"  æ ‡ç­¾: {tags}")
    print(f"  Emoji: {' '.join(emojis)}")
```

**è¾“å‡º**:
```
æ–‡æœ¬: è¿™ä¸ªåŒ»é™¢äººå¾ˆå¤šï¼Œç¯å¢ƒå¾ˆå˜ˆæ‚
  æ ‡ç­¾: ['å˜ˆæ‚', 'æ‹¥æŒ¤']
  Emoji: ğŸ”Š ğŸ‘¥

æ–‡æœ¬: å«ç”Ÿé—´å¾ˆå¹²å‡€ï¼Œæ¨èä½¿ç”¨
  æ ‡ç­¾: ['æ¨è', 'æ•´æ´']
  Emoji: â­ âœ¨

æ–‡æœ¬: ç­‰å€™å¤§å…å®½æ•æ˜äº®ï¼Œå¾ˆæ¸©é¦¨
  æ ‡ç­¾: ['å®½æ•', 'æ˜äº®', 'æ¸©é¦¨']
  Emoji: ğŸ›ï¸ ğŸ’¡ ğŸ’
```

### æµ‹è¯•3: å®Œæ•´æµç¨‹æµ‹è¯•

åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_emotional_map_complete.py`:

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
import json
from pathlib import Path

# æ·»åŠ coreåˆ°è·¯å¾„
sys.path.insert(0, str(Path(__file__).parent))

from core.emotional_tagger import EmotionalTagger
from core.node_layer_manager import NodeLayerManager
from core.adjacency_graph_builder import AdjacencyGraphBuilder
from core.emotional_map_card_generator import EmotionalMapCardGenerator

def main():
    # åˆ›å»ºæµ‹è¯•æ•°æ®
    test_data = {
        "paths": [
            {
                "path_id": "test_emotional_path",
                "path_name": "æµ‹è¯•æƒ…ç»ªè·¯å¾„",
                "nodes": [
                    {"node_id": "node1", "label": "åŒ»é™¢å…¥å£", "type": "entrance", 
                     "note": "äººå¾ˆå¤šå¾ˆæ‹¥æŒ¤"},
                    {"node_id": "node2", "label": "ä¸€æ¥¼å¤§å…", "type": "building", 
                     "note": "å®½æ•æ˜äº®æ¨è"},
                    {"node_id": "node3", "label": "å«ç”Ÿé—´", "type": "toilet", 
                     "note": "å¾ˆå®‰é™å¹²å‡€æ•´æ´"},
                    {"node_id": "node4", "label": "ç”µæ¢¯é—´", "type": "elevator", 
                     "note": ""},
                    {"node_id": "node5", "label": "ç›®çš„åœ°", "type": "destination", 
                     "note": "æ¸©é¦¨èˆ’é€‚"},
                ]
            }
        ]
    }
    
    # ä¿å­˜æµ‹è¯•æ•°æ®
    with open("data/test_memory.json", 'w', encoding='utf-8') as f:
        json.dump(test_data, f, ensure_ascii=False, indent=2)
    
    print("=" * 60)
    print("æƒ…ç»ªåœ°å›¾å®Œæ•´æµç¨‹æµ‹è¯•")
    print("=" * 60)
    
    # æ­¥éª¤1: åˆ†é…å±‚çº§
    print("\n1ï¸âƒ£ åˆ†é…èŠ‚ç‚¹å±‚çº§...")
    manager = NodeLayerManager()
    manager.update_all_levels("data/test_memory.json")
    
    # æ­¥éª¤2: æ„å»ºé‚»æ¥å›¾
    print("\n2ï¸âƒ£ æ„å»ºé‚»æ¥å›¾...")
    builder = AdjacencyGraphBuilder()
    builder.build_adjacency_graph("data/test_memory.json")
    
    # æ­¥éª¤3: æ ‡æ³¨æƒ…ç»ª
    print("\n3ï¸âƒ£ æ ‡æ³¨æƒ…ç»ªæ ‡ç­¾...")
    tagger = EmotionalTagger()
    tagger.tag_nodes_with_emotion("data/test_memory.json")
    
    # æ­¥éª¤4: ç”Ÿæˆæƒ…ç»ªåœ°å›¾
    print("\n4ï¸âƒ£ ç”Ÿæˆæƒ…ç»ªåœ°å›¾...")
    generator = EmotionalMapCardGenerator(memory_store_path="data/test_memory.json")
    result = generator.generate_emotional_map("test_emotional_path")
    
    if result:
        print(f"\nâœ… æƒ…ç»ªåœ°å›¾ç”ŸæˆæˆåŠŸ: {result}")
    else:
        print("\nâŒ æƒ…ç»ªåœ°å›¾ç”Ÿæˆå¤±è´¥")
    
    print("\n" + "=" * 60)
    print("æµ‹è¯•å®Œæˆ")
    print("=" * 60)

if __name__ == "__main__":
    main()
```

---

## ğŸ“Š è¾“å‡ºç¤ºä¾‹

### ç”Ÿæˆçš„PNGåœ°å›¾ç‰¹å¾

- **ç”»å¸ƒå°ºå¯¸**: 2400 x 1800
- **çº¸å¼ é¢œè‰²**: ç±³é»„è‰² (#F9F7EE)
- **çº¿æ¡é¢œè‰²**: é»‘è‰² (#323232)
- **å¸ƒå±€**: èºæ—‹åˆ†å¸ƒ
- **å›¾æ ‡**: æ‰‹ç»˜é£æ ¼ç®€ç¬”ç”»
- **æƒ…ç»ªæ ‡ç­¾**: å½©è‰²åœ†å½¢+emoji
- **æ–‡å­—**: é»˜è®¤ç³»ç»Ÿå­—ä½“

### æƒ…ç»ªåœ°å›¾å¯è§†åŒ–å…ƒç´ 

1. **èŠ‚ç‚¹**:
   - å¸¦ç¼–å·çš„åœ†å½¢èŠ‚ç‚¹
   - ç±»å‹å›¾æ ‡ï¼ˆå»ºç­‘/å«ç”Ÿé—´/ç”µæ¢¯ç­‰ï¼‰
   - èŠ‚ç‚¹æ ‡ç­¾

2. **è·¯å¾„**:
   - æŠ–åŠ¨çº¿æ¡è¿æ¥èŠ‚ç‚¹
   - ç®­å¤´æŒ‡ç¤ºæ–¹å‘

3. **æƒ…ç»ªæ ‡ç­¾**:
   - å½©è‰²åœ†å½¢èƒŒæ™¯
   - Emojiå›¾æ ‡
   - åŠé€æ˜æ•ˆæœ

4. **æ ‡é¢˜**:
   - "æƒ…ç»ªåœ°å›¾: è·¯å¾„åç§°"
   - å·¦ä¸Šè§’æ˜¾ç¤º

---

## ğŸ”„ æœªæ¥æ‰©å±•

### è®¡åˆ’åŠŸèƒ½

1. **PDFè¾“å‡ºæ”¯æŒ**
   - æ”¯æŒç”Ÿæˆé«˜è´¨é‡PDFåœ°å›¾
   - å¯æ‰“å°ç‰ˆæœ¬

2. **3Då±‚çº§å¯è§†åŒ–**
   - åˆ†å±‚æ˜¾ç¤ºä¸åŒæ¥¼å±‚
   - ç«‹ä½“è·¯å¾„å›¾

3. **äº¤äº’å¼åœ°å›¾**
   - HTML5äº¤äº’å¼åœ°å›¾
   - é¼ æ ‡æ‚¬åœæŸ¥çœ‹è¯¦æƒ…

4. **è·¯å¾„ä¼˜åŒ–**
   - Dijkstraæœ€çŸ­è·¯å¾„ç®—æ³•
   - A*è·¯å¾„æœç´¢
   - é¿éšœè·¯å¾„è§„åˆ’

5. **è¯­éŸ³åœ°å›¾æè¿°**
   - åŸºäºæƒ…ç»ªæ ‡ç­¾ç”Ÿæˆè¯­éŸ³å¯¼èˆª
   - TTSé›†æˆ

6. **ç”¨æˆ·åé¦ˆé›†æˆ**
   - å®æ—¶æ›´æ–°æƒ…ç»ªæ ‡ç­¾
   - ç”¨æˆ·æ ‡æ³¨åŠŸèƒ½

---

## ğŸ› å·²çŸ¥é™åˆ¶

1. **å­—ä½“ä¾èµ–**: éœ€è¦ç³»ç»Ÿå­—ä½“æ”¯æŒemoji
2. **å›¾æ ‡æ ·å¼**: ç›®å‰ä½¿ç”¨ç®€å•çš„å‡ ä½•å›¾å½¢
3. **æ€§èƒ½**: å¤§è§„æ¨¡èŠ‚ç‚¹å¯èƒ½è¾ƒæ…¢
4. **æƒ…ç»ªè¯†åˆ«**: åŸºäºå…³é”®è¯ï¼Œå¯èƒ½ä¸å¤Ÿå‡†ç¡®

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2025-10-30)

- âœ… å››ä¸ªæ ¸å¿ƒæ¨¡å—å…¨éƒ¨å®ç°
- âœ… æ–‡æ¡£ç¼–å†™å®Œæˆ
- âœ… æµ‹è¯•ç”¨ä¾‹å®Œæˆ
- âœ… æ‰‹ç»˜é£æ ¼æ¸²æŸ“å®ç°
- âœ… æƒ…ç»ªæ ‡æ³¨ç³»ç»Ÿå®Œæˆ

---

**è§£å†³æ–¹æ¡ˆå®Œæˆæ—¥æœŸ**: 2025-10-30  
**ç³»ç»Ÿç‰ˆæœ¬**: Luna Badge v1.6+  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

*Luna Badge - è®©å¯¼èˆªæ›´ç›´è§‚ï¼Œè®©æƒ…ç»ªå¯æ„ŸçŸ¥*


