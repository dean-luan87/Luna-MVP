# ä»»åŠ¡å›¾æ–‡ä»¶æ ‡å‡†æ ¼å¼è¯´æ˜

## ğŸ“‹ ä»»åŠ¡å›¾JSONæ–‡ä»¶ç»“æ„

æ‰€æœ‰ä»»åŠ¡å›¾æ–‡ä»¶ï¼ˆ`.json`ï¼‰å¿…é¡»éµå¾ªä»¥ä¸‹æ ‡å‡†æ ¼å¼ï¼Œä»¥ä¾¿ä»»åŠ¡å¼•æ“æ­£ç¡®åŠ è½½å’Œæ‰§è¡Œã€‚

---

## ğŸ—ï¸ æ–‡ä»¶ç»“æ„

### é¡¶å±‚å­—æ®µ

```json
{
  "graph_id": "unique_task_id",      // å¿…éœ€ï¼šä»»åŠ¡é“¾å”¯ä¸€æ ‡è¯†
  "scene_type": "scene_category",     // å¿…éœ€ï¼šåœºæ™¯ç±»åˆ«
  "goal": "ä»»åŠ¡ç›®æ ‡æè¿°",              // å¿…éœ€ï¼šä»»åŠ¡ç›®æ ‡
  "entry_trigger": "è§¦å‘æ¡ä»¶",         // å¯é€‰ï¼šè§¦å‘ä»»åŠ¡çš„ç”¨æˆ·è¯­å¥
  "target": {                         // å¯é€‰ï¼šç›®æ ‡ä¿¡æ¯
    "location": "ç›®æ ‡åœ°ç‚¹",
    "service_type": "æœåŠ¡ç±»å‹"
  },
  "nodes": [...],                     // å¿…éœ€ï¼šä»»åŠ¡èŠ‚ç‚¹åˆ—è¡¨
  "edges": [...],                     // å¯é€‰ï¼šèŠ‚ç‚¹è¿æ¥å…³ç³»
  "metadata": {...}                   // å¯é€‰ï¼šå…ƒæ•°æ®
}
```

---

## ğŸ“¦ èŠ‚ç‚¹ï¼ˆNodeï¼‰ç»“æ„

### å¿…éœ€å­—æ®µ

```json
{
  "id": "node_unique_id",            // èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†
  "type": "node_type",                // èŠ‚ç‚¹ç±»å‹ï¼ˆè§ä¸‹æ–¹ï¼‰
  "title": "èŠ‚ç‚¹æ ‡é¢˜",                 // ç”¨æˆ·å¯æ„ŸçŸ¥çš„ä»»åŠ¡æ ‡é¢˜
  "status": "pending"                 // èŠ‚ç‚¹çŠ¶æ€ï¼ˆpending/running/completed/failedï¼‰
}
```

### å¯é€‰å­—æ®µ

```json
{
  "expected_input": "æœŸæœ›è¾“å…¥",        // èŠ‚ç‚¹æœŸæœ›çš„è¾“å…¥
  "output": "è¾“å‡ºç»“æœ",               // èŠ‚ç‚¹è¾“å‡º
  "input": "è¾“å…¥æ•°æ®",                // è¾“å…¥æ•°æ®ï¼ˆä¸expected_inputç­‰ä»·ï¼‰
  "trigger": "è§¦å‘æ¡ä»¶",              // è§¦å‘æ¡ä»¶ï¼ˆç”¨äºenvironmental_stateç±»å‹ï¼‰
  "fallback_action": "å®¹é”™è¡Œä¸º",       // å¤±è´¥æ—¶çš„å®¹é”™è¡Œä¸º
  "timeout": 300,                     // è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  "config": {                         // èŠ‚ç‚¹é…ç½®
    // æ ¹æ®èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œé…ç½®å†…å®¹ä¸åŒ
  }
}
```

---

## ğŸ¯ èŠ‚ç‚¹ç±»å‹ï¼ˆNode Typeï¼‰

| ç±»å‹ | è¯´æ˜ | å…¸å‹ç”¨é€” | é…ç½®ç¤ºä¾‹ |
|------|------|----------|---------|
| `interaction` | ç”¨æˆ·äº¤äº’ | è¯¢é—®ç”¨æˆ·ã€è·å–ç¡®è®¤ | `{"question": "é—®é¢˜", "options": ["é€‰é¡¹"]}` |
| `navigation` | å¯¼èˆªä»»åŠ¡ | è§„åˆ’è·¯çº¿ã€æ‰§è¡Œå¯¼èˆª | `{"destination": "åœ°ç‚¹", "transport_mode": "walking"}` |
| `observation` | è§‚å¯Ÿè¯†åˆ« | OCRè¯†åˆ«ã€è§†è§‰æ£€æµ‹ | `{"type": "ocr", "target": "signboard"}` |
| `condition_check` | æ¡ä»¶æ£€æŸ¥ | æ£€æŸ¥å‰ç½®æ¡ä»¶ | `{"condition": "æ¡ä»¶", "required_items": []}` |
| `external_call` | å¤–éƒ¨æœåŠ¡ | è°ƒç”¨å¤–éƒ¨API/æœåŠ¡ | `{"service": "service_name"}` |
| `memory_action` | è®°å¿†æ“ä½œ | ä¿å­˜/è¯»å–è®°å¿† | `{"action": "save", "memory_type": "type"}` |
| `environmental_state` | ç¯å¢ƒçŠ¶æ€ | ç›‘å¬ç¯å¢ƒå˜åŒ– | `{"trigger": "è§¦å‘æ¡ä»¶"}` |

---

## ğŸ”— è¾¹ï¼ˆEdgeï¼‰ç»“æ„

```json
{
  "from": "source_node_id",          // æºèŠ‚ç‚¹ID
  "to": "target_node_id"             // ç›®æ ‡èŠ‚ç‚¹ID
}
```

**è¯´æ˜ï¼š**
- å¦‚æœæœªæä¾›`edges`å­—æ®µï¼Œç³»ç»Ÿå°†æŒ‰èŠ‚ç‚¹é¡ºåºè‡ªåŠ¨è¿æ¥
- æ”¯æŒæ¡ä»¶åˆ†æ”¯ï¼ˆé€šè¿‡`condition`å­—æ®µï¼Œæœªæ¥æ‰©å±•ï¼‰

---

## ğŸ“Š å…ƒæ•°æ®ï¼ˆMetadataï¼‰

```json
{
  "estimated_duration": 120,         // é¢„è®¡æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  "complexity": "high",              // å¤æ‚åº¦ï¼šlow/medium/high
  "user_interaction_level": "high",  // ç”¨æˆ·äº¤äº’çº§åˆ«ï¼šlow/medium/high
  "ai_assistance_level": "high",     // AIè¾…åŠ©çº§åˆ«ï¼šlow/medium/high
  "insertable_tasks": ["toilet", "snack"],  // å¯æ’å…¥çš„ä»»åŠ¡ç±»å‹
  "version": "1.0"                   // ç‰ˆæœ¬å·
}
```

---

## ğŸ“ å­—æ®µè¯´æ˜

### æ ¸å¿ƒå­—æ®µ

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `graph_id` | string | âœ… | ä»»åŠ¡é“¾å”¯ä¸€æ ‡è¯† |
| `scene_type` | string | âœ… | åœºæ™¯ç±»åˆ«ï¼šhospital/government/retail/transportç­‰ |
| `goal` | string | âœ… | ä»»åŠ¡ç›®æ ‡æè¿° |
| `entry_trigger` | string | âŒ | è§¦å‘ä»»åŠ¡çš„ç”¨æˆ·è¯­å¥æˆ–äº‹ä»¶ |
| `target` | object | âŒ | ç›®æ ‡ä¿¡æ¯ï¼ˆåœ°ç‚¹ã€æœåŠ¡ç±»å‹ç­‰ï¼‰ |
| `nodes` | array | âœ… | ä»»åŠ¡èŠ‚ç‚¹åˆ—è¡¨ï¼ˆè‡³å°‘1ä¸ªï¼‰ |
| `edges` | array | âŒ | èŠ‚ç‚¹è¿æ¥å…³ç³»ï¼ˆå¯é€‰ï¼Œé»˜è®¤é¡ºåºè¿æ¥ï¼‰ |
| `metadata` | object | âŒ | å…ƒæ•°æ®ä¿¡æ¯ |

### èŠ‚ç‚¹å­—æ®µ

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `id` | string | âœ… | èŠ‚ç‚¹å”¯ä¸€æ ‡è¯† |
| `type` | string | âœ… | èŠ‚ç‚¹ç±»å‹ |
| `title` | string | âœ… | èŠ‚ç‚¹æ ‡é¢˜ |
| `status` | string | âœ… | èŠ‚ç‚¹çŠ¶æ€ |
| `expected_input` | string | âŒ | æœŸæœ›è¾“å…¥ |
| `output` | string | âŒ | è¾“å‡ºç»“æœ |
| `input` | string | âŒ | è¾“å…¥æ•°æ®ï¼ˆä¸expected_inputç­‰ä»·ï¼‰ |
| `trigger` | string | âŒ | è§¦å‘æ¡ä»¶ |
| `fallback_action` | string | âŒ | å®¹é”™è¡Œä¸º |
| `timeout` | number | âŒ | è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `config` | object | âŒ | èŠ‚ç‚¹é…ç½® |

---

## ğŸ“‹ åœºæ™¯ç±»å‹ï¼ˆScene Typeï¼‰

| åœºæ™¯ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| `hospital` | åŒ»é™¢åœºæ™¯ | æŒ‚å·ã€å°±è¯Šã€å–è¯ |
| `government` | æ”¿åŠ¡æœåŠ¡ | åŠè¯ã€åŠäº‹ |
| `retail` | é›¶å”®è´­ç‰© | è¶…å¸‚ã€å•†åœº |
| `transport` | äº¤é€šå‡ºè¡Œ | å…¬äº¤ã€åœ°é“ã€æ­¥è¡Œ |
| `custom` | è‡ªå®šä¹‰åœºæ™¯ | ç”¨æˆ·è‡ªå®šä¹‰ä»»åŠ¡ |

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´ç¤ºä¾‹

å‚è€ƒ `hospital_visit.json`ã€`government_service.json`ã€`shopping_mall.json`

### åˆ›å»ºæ–°ä»»åŠ¡å›¾

1. å¤åˆ¶ `task_graph_template.json`
2. ä¿®æ”¹ `graph_id`ã€`scene_type`ã€`goal`
3. æ·»åŠ /ä¿®æ”¹èŠ‚ç‚¹åˆ—è¡¨
4. å®šä¹‰èŠ‚ç‚¹è¿æ¥å…³ç³»ï¼ˆedgesï¼‰
5. å¡«å†™å…ƒæ•°æ®

---

## âœ… éªŒè¯æ£€æŸ¥æ¸…å•

åˆ›å»ºä»»åŠ¡å›¾æ–‡ä»¶åï¼Œè¯·æ£€æŸ¥ï¼š

- [ ] `graph_id` å”¯ä¸€ä¸”æœ‰æ„ä¹‰
- [ ] `scene_type` ç¬¦åˆæ ‡å‡†ç±»å‹
- [ ] `goal` æ¸…æ™°æè¿°ä»»åŠ¡ç›®æ ‡
- [ ] `nodes` è‡³å°‘åŒ…å«1ä¸ªèŠ‚ç‚¹
- [ ] æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ `id`ã€`type`ã€`title`ã€`status`
- [ ] èŠ‚ç‚¹ç±»å‹ç¬¦åˆæ”¯æŒçš„ç±»å‹
- [ ] `edges` ä¸­çš„èŠ‚ç‚¹IDåœ¨ `nodes` ä¸­å­˜åœ¨
- [ ] `timeout` å€¼åˆç†ï¼ˆä¸å®œè¿‡å¤§ï¼‰
- [ ] `metadata` åŒ…å«å¿…è¦çš„å…ƒä¿¡æ¯

---

## ğŸ”§ å·¥å…·æ”¯æŒ

ä½¿ç”¨ `task_graph_loader.py` å¯ä»¥ï¼š
- âœ… è‡ªåŠ¨æ ¡éªŒå­—æ®µå®Œæ•´æ€§
- âœ… åŠ è½½JSONæ–‡ä»¶ä¸ºTaskGraphå¯¹è±¡
- âœ… ä»APIåŠ è½½ï¼ˆé¢„ç•™æ¥å£ï¼‰

---

## ğŸ“š å‚è€ƒæ–‡ä»¶

- `hospital_visit.json` - åŒ»é™¢å°±è¯Šæµç¨‹ï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰
- `government_service.json` - æ”¿åŠ¡æœåŠ¡æµç¨‹
- `shopping_mall.json` - è´­ç‰©æµç¨‹
- `task_graph_template.json` - æ¨¡æ¿æ–‡ä»¶

---

**éµå¾ªæ­¤æ ‡å‡†æ ¼å¼ï¼Œå¯ç¡®ä¿ä»»åŠ¡å›¾æ–‡ä»¶ä¸ä»»åŠ¡å¼•æ“å®Œç¾å…¼å®¹ï¼** âœ…
